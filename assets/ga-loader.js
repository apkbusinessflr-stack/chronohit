(function(){let loaded=false;async function cfg(){try{const r=await fetch('/api/ga-config',{credentials:'same-origin'});return await r.json()}catch(e){return{enabled:false}}}
function inject(id){if(loaded||!id)return;const s=document.createElement('script');s.async=true;s.src='https://www.googletagmanager.com/gtag/js?id='+encodeURIComponent(id);s.onload=init.bind(null,id);document.head.appendChild(s)}function init(id){if(loaded)return;window.dataLayer=window.dataLayer||[];function g(){dataLayer.push(arguments)}window.gtag=g;g('js',new Date());g('config',id,{anonymize_ip:true,send_page_view:true});loaded=true}
async function boot(){const c=await cfg();if(!c?.enabled)return;inject(c.id)}if(document.readyState==='loading')document.addEventListener('DOMContentLoaded',boot);else boot()})();