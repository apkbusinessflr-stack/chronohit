window.ChronoAds=(function(){let cfg=null,scriptLoaded=false,queue=[];async function fetchCfg(){if(cfg!==null)return cfg;try{const r=await fetch('/api/ads-config');cfg=await r.json()}catch(e){cfg={enabled:false}}return cfg}
function inject(client){if(scriptLoaded)return;const s=document.createElement('script');s.async=true;s.src='https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client='+encodeURIComponent(client);s.crossOrigin='anonymous';s.onload=()=>{scriptLoaded=true;flush()};document.head.appendChild(s)}
function flush(){(window.adsbygoogle=window.adsbygoogle||[]);queue.forEach(()=>window.adsbygoogle.push({}));queue=[]}
function render(el,client,slot){if(!el||!client||!slot)return;el.innerHTML='';const ins=document.createElement('ins');ins.className='adsbygoogle';ins.style.display='block';ins.style.minHeight='90px';ins.setAttribute('data-ad-client',client);ins.setAttribute('data-ad-slot',slot);ins.setAttribute('data-ad-format','auto');ins.setAttribute('data-full-width-responsive','true');el.appendChild(ins);queue.push({});if(scriptLoaded)flush()}
async function load({targetId,slotKey}){const c=await fetchCfg();if(!c.enabled)return;inject(c.publisher);const slot=(c.slots||{})[slotKey];render(document.getElementById(targetId),c.publisher,slot)}
return{load}})();