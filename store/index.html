<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Buy Credits — ChronoHit</title>
  <link rel="stylesheet" href="/assets/chronohit.css" />
  <script type="module">
    import { getDeviceId } from "/assets/utils.js";
    const userId = getDeviceId();

    async function buy(priceId, btn) {
      btn.disabled = true;
      try {
        const r = await fetch("/api/stripe/checkout", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ priceId, userId })
        });
        const j = await r.json();
        if (!r.ok) throw new Error(j.error || "Checkout failed");
        window.location = j.url;
      } catch (e) {
        alert(e.message || "Error");
      } finally {
        btn.disabled = false;
      }
    }

    window.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll("[data-price]").forEach(btn => {
        btn.addEventListener("click", () => buy(btn.dataset.price, btn));
      });
    });
  </script>
</head>
<body>
<header class="header">
  <a href="/" class="logo"><img src="/assets/logo.svg" alt=""><span class="brand">ChronoHit</span></a>
  <nav class="navright"><a href="/store/">Store</a></nav>
</header>

<main class="container">
  <section class="card">
    <h1>Buy credits</h1>
    <p class="lead">Instant delivery to your wallet after payment.</p>
    <div class="row" style="gap:8px;flex-wrap:wrap">
      <!-- Βάλε τα δικά σου Price IDs -->
      <button class="btn" data-price="price_XXX_100">€3 → 100 credits</button>
      <button class="btn" data-price="price_XXX_200">€5 → 200 credits</button>
      <button class="btn" data-price="price_XXX_600">€10 → 600 credits</button>
    </div>
  </section>
</main>

<footer class="footer">© 2025 ChronoHit</footer>
</body>
</html>
